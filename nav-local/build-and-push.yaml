version: 1.0-preview-1
stepTimeout: 10800
totalTimeout: 10800
steps:
  - id: build-dk-1803
    build: -t {{.Run.Registry}}/nav:{{.Run.ID}}-dk-1803 --build-arg baseimage={{.Values.baseimage}}-1803 --build-arg countryurl={{.Values.countryurl}} --build-arg country={{.Values.country}} --build-arg created={{.Values.created}} -f ./DOCKERFILE https://github.com/Microsoft/nav-docker.git#master:nav-local
  - id: push-dk-1803
    push: ["{{.Run.Registry}}/nav:{{.Run.ID}}-dk-1803"]
    when: ["build-dk-1803"]
  - id: build-dk-1709
    build: -t {{.Run.Registry}}/nav:{{.Run.ID}}-dk-1709 --build-arg baseimage={{.Values.baseimage}}-1709 --build-arg countryurl={{.Values.countryurl}} --build-arg country={{.Values.country}} --build-arg created={{.Values.created}} -f ./DOCKERFILE https://github.com/Microsoft/nav-docker.git#master:nav-local
  - id: push-dk-1709
    push: ["{{.Run.Registry}}/nav:{{.Run.ID}}-dk-1709"]
    when: ["build-dk-1709"]
  - id: build-dk-ltsc2016
    build: -t {{.Run.Registry}}/nav:{{.Run.ID}}-dk-ltsc2016 --build-arg baseimage={{.Values.baseimage}}-ltsc2016 --build-arg countryurl={{.Values.countryurl}} --build-arg country={{.Values.country}} --build-arg created={{.Values.created}} -f ./DOCKERFILE https://github.com/Microsoft/nav-docker.git#master:nav-local
  - id: push-dk-ltsc2016
    push: ["{{.Run.Registry}}/nav:{{.Run.ID}}-dk-ltsc2016"]
    when: ["build-dk-ltsc2016"]
